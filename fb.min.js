// JS Code Author: Shu Ding. Email: ds303077135@gmail.com.
var canvas,ctx;var width,height;var sky,land,bird,pipe,pipeUp,pipeDown,scoreBoard,ready,splash;var dist,birdY,birdF,birdN,birdV;var animation,death,deathAnim;var pipes=[],pipeSt,pipeNumber;var score;var clearCanvas=function(){ctx.fillStyle="#4EC0CA";ctx.fillRect(0,0,width,height)};var loadImages=function(){var e=9,t=0;var n=function(){t++;if(t==e){death=1;dist=0;birdY=(height-112)/2;birdF=0;birdN=0;birdV=0;score=0;pipeSt=0;pipeNumber=10;pipes=[];for(var n=0;n<10;++n)pipes.push(Math.floor(Math.random()*(height-300)+10));drawCanvas()}};sky=new Image;sky.src="images/sky.png";sky.onload=n;land=new Image;land.src="images/land.png";land.onload=n;bird=new Image;bird.src="images/bird.png";bird.onload=n;pipe=new Image;pipe.src="images/pipe.png";pipe.onload=n;pipeUp=new Image;pipeUp.src="images/pipe-up.png";pipeUp.onload=n;pipeDown=new Image;pipeDown.src="images/pipe-down.png";pipeDown.onload=n;scoreBoard=new Image;scoreBoard.src="images/scoreboard.png";scoreBoard.onload=n;ready=new Image;ready.src="images/replay.png";ready.onload=n;splash=new Image;splash.src="images/splash.png";splash.onload=n};var initCanvas=function(){canvas=document.getElementById("canvas");ctx=canvas.getContext("2d");canvas.width=width=window.innerWidth;canvas.height=height=window.innerHeight;canvas.onclick=jump;window.onkeydown=jump;loadImages()};var deathAnimation=function(){if(splash){ctx.drawImage(splash,width/2-94,height/2-54);splash=undefined}else ctx.drawImage(scoreBoard,width/2-118,height/2-54);ctx.drawImage(ready,width/2-57,height/2+10)};var drawSky=function(){var e=0;while(e<width){ctx.drawImage(sky,e,height-221);e+=sky.width}};var drawLand=function(){var e=-dist;while(e<width){ctx.drawImage(land,e,height-112);e+=land.width}dist=dist+2;if(dist>=width*.65&&Math.floor(dist-width*.65)%220==0){score++}};var drawPipe=function(e,t){ctx.drawImage(pipe,e,0,pipe.width,t);ctx.drawImage(pipeDown,e,t);ctx.drawImage(pipe,e,t+168,pipe.width,height-112);ctx.drawImage(pipeUp,e,t+144);if(e<width*.35+34&&e+52>width*.35&&(birdY<t+24||birdY+24>t+144)){clearInterval(animation);death=1}else if(e+40<0){pipeSt++;pipeNumber++;pipes.push(Math.floor(Math.random()*(height-300)+10))}};var drawBird=function(){ctx.drawImage(bird,0,birdN*24,bird.width,bird.height/4,width*.35,birdY,bird.width,bird.height/4);birdF=(birdF+1)%6;if(birdF%6==0)birdN=(birdN+1)%4;birdY-=birdV;birdV-=.5;if(birdY+138>height){clearInterval(animation);death=1}if(death)deathAnimation()};var drawScore=function(){ctx.font='20px "Press Start 2P"';ctx.lineWidth=5;ctx.strokeStyle="#fff";ctx.fillStyle="#000";var e=""+score;ctx.strokeText(e,(width-ctx.measureText(e).width)/2,height*.15);ctx.fillText(e,(width-ctx.measureText(e).width)/2,height*.15)};var drawCanvas=function(){clearCanvas();drawSky();for(var e=pipeSt;e<pipeNumber;++e)drawPipe(width-dist+e*220,pipes[e]);drawLand();drawBird();drawScore()};var anim=function(){animation=setInterval(drawCanvas,1e3/60)};var jump=function(){if(death){dist=0;birdY=(height-112)/2;birdF=0;birdN=0;birdV=0;death=0;score=0;pipeSt=0;pipeNumber=10;pipes=[];for(var e=0;e<10;++e)pipes.push(Math.floor(Math.random()*(height-300)+10));anim()}birdV=8};window.onload=function(){initCanvas()}